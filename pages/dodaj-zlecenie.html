<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dodaj zlecenie ‚Äî ZLECAJ z LUMENA</title>

  <!-- SEO -->
  <meta name="description" content="Dodaj darmowe zlecenie i odbierz oferty od firm. ZLECAJ z LUMENA ‚Äî bez op≈Çat, bez po≈õrednik√≥w.">
  <meta name="author" content="LUMENA Creative" />
  <link rel="canonical" href="https://zlecajzlumena.pl/pages/dodaj-zlecenie.html" />

  <!-- Favicon -->
  <link rel="icon" href="/image/favicon.png" type="image/png">
  <meta name="theme-color" content="#0b0b0f" />

  <!-- Fonts & CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css" />
</head>

<body>
  <!-- HEADER -->
  <header class="topbar">
    <div class="wrap flex between center-v">
      <a href="/" class="logo">
        <img src="/image/zlecaj-z-lumena.png" alt="ZLECAJ z LUMENA" height="48">
      </a>
      <nav class="nav">
        <a href="/pages/panel-klient.html">Panel klienta</a>
      </nav>
    </div>
  </header>

  <!-- FORMULARZ -->
  <section class="form-section">
    <div class="wrap">
      <h1>Dodaj zlecenie</h1>
      <p class="subtitle">Opisz swoje zlecenie i poczekaj na oferty od firm üíé</p>

      <form id="addOrderForm" class="zlecenie-form">
        <div class="form-group">
          <label for="tytul">Tytu≈Ç zlecenia *</label>
          <input type="text" id="tytul" required placeholder="np. Malowanie mieszkania 50m¬≤ w Krakowie">
        </div>

        <div class="form-group">
          <label for="opis">Opis zlecenia *</label>
          <textarea id="opis" rows="4" required placeholder="Opisz dok≈Çadnie zakres prac, termin i szczeg√≥≈Çy."></textarea>
        </div>

        <div class="grid-2">
          <div class="form-group">
            <label for="miasto">Miasto *</label>
            <input type="text" id="miasto" required placeholder="np. Krak√≥w">
          </div>

          <div class="form-group">
            <label for="kategoria">Kategoria *</label>
            <select id="kategoria" required>
              <option value="">Wybierz kategoriƒô</option>
              <option value="Remonty i budowa">Remonty i budowa</option>
              <option value="Wyko≈Ñczenia wnƒôtrz">Wyko≈Ñczenia wnƒôtrz</option>
              <option value="Ogr√≥d i zewnƒôtrza">Ogr√≥d i zewnƒôtrza</option>
              <option value="Us≈Çugi projektowe">Us≈Çugi projektowe</option>
              <option value="Transport i przeprowadzki">Transport i przeprowadzki</option>
              <option value="Inne">Inne</option>
            </select>
          </div>
        </div>

        <div class="form-actions center">
          <button type="submit" class="cta">Dodaj zlecenie</button>
        </div>
      </form>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="lumena-footer">
    <div class="wrap foot">
      <div>
        <h5>Sekcje</h5>
        <a href="/pages/oferty.html">Zlecenia</a>
        <a href="/pages/rejestracja.html">Rejestracja</a>
        <a href="/pages/login.html">Logowanie</a>
      </div>
      <div>
        <h5>Informacje</h5>
        <a href="/pages/o-lumena.html">O LUMENA</a>
        <a href="/pages/polityka.html">Polityka prywatno≈õci</a>
        <a href="/pages/rodo.html">RODO</a>
        <a href="/pages/bezpieczenstwo.html">Poradnik bezpiecze≈Ñstwa</a>
      </div>
      <div>
        <h5>Kontakt</h5>
        <a href="mailto:kontakt.lumena.studio@gmail.com">kontakt.lumena.studio@gmail.com</a>
        <a href="#">Instagram</a>
        <a href="#">Pinterest</a>
      </div>
    </div>

    <div class="copy">
      ¬© 2025 <span class="gold">LUMENA Creative</span> üíé  
      <br><small>Wszystkie prawa zastrze≈ºone.</small>
    </div>
  </footer>

  <!-- üî• FIREBASE: zapisywanie zlecenia -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-auth.js";
    import { getFirestore, addDoc, collection, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-firestore.js";

    // Konfiguracja Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyDgaH3j1FKB0mPkCqH7VG9vwhX1q82NkR0",
      authDomain: "zlecaj-z-lumena.firebaseapp.com",
      projectId: "zlecaj-z-lumena",
      storageBucket: "zlecaj-z-lumena.appspot.com",
      messagingSenderId: "46650398157",
      appId: "1:46650398157:web:cd4d90782bb3039b8ce354",
      measurementId: "G-W8TCWBDE7Y"
    };

    // Inicjalizacja Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const form = document.getElementById("addOrderForm");

    onAuthStateChanged(auth, (user) => {
      if (!user) {
        alert("Musisz byƒá zalogowany, aby dodaƒá zlecenie üíé");
        window.location.href = "/pages/login.html";
        return;
      }

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const tytul = document.getElementById("tytul").value.trim();
        const opis = document.getElementById("opis").value.trim();
        const miasto = document.getElementById("miasto").value.trim();
        const kategoria = document.getElementById("kategoria").value;

        if (!tytul || !opis || !miasto || !kategoria) {
          alert("Uzupe≈Çnij wszystkie pola üíé");
          return;
        }

        try {
          const docRef = await addDoc(collection(db, "zlecenia"), {
            tytul,
            opis,
            miasto,
            kategoria,
            autorId: user.uid,
            autorEmail: user.email,
            createdAt: serverTimestamp()
          });

          alert("‚úÖ Zlecenie zosta≈Ço dodane pomy≈õlnie!");
          window.location.href = `/pages/szczegoly-zlecenia.html?id=${docRef.id}`;
        } catch (err) {
          console.error("‚ùå B≈ÇƒÖd dodawania zlecenia:", err);
          alert("WystƒÖpi≈Ç b≈ÇƒÖd podczas zapisu. Spr√≥buj ponownie.");
        }
      });
    });
  </script>

  <!-- COOKIE BANNER -->
  <div id="cookie-banner" class="cookie-banner" style="display:none;">
    <div class="cookie-content">
      <p>
        üç™ Ta strona korzysta z plik√≥w cookie, aby zapewniƒá Ci najlepsze do≈õwiadczenie,  
        analizowaƒá ruch oraz wy≈õwietlaƒá dopasowane reklamy Google.  
        Wiƒôcej informacji znajdziesz w naszej  
        <a href="/pages/cookies.html" target="_blank">Polityce plik√≥w cookies</a>.
      </p>
      <div class="cookie-actions">
        <button id="acceptCookies" class="cta">Akceptujƒô</button>
        <button id="declineCookies" class="cta secondary">Odrzuƒá</button>
      </div>
    </div>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const banner = document.getElementById("cookie-banner");
    const accepted = localStorage.getItem("lumena_cookies_accepted");

    if (!accepted) banner.style.display = "flex";

    document.getElementById("acceptCookies").addEventListener("click", () => {
      localStorage.setItem("lumena_cookies_accepted", "true");
      banner.style.display = "none";
    });

    document.getElementById("declineCookies").addEventListener("click", () => {
      localStorage.setItem("lumena_cookies_accepted", "false");
      banner.style.display = "none";
    });
  });
  </script>

  <style>
    .form-section { padding: 60px 0; }
    .zlecenie-form .form-group { margin-bottom: 20px; }
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    @media (max-width: 768px) {
      .grid-2 { grid-template-columns: 1fr; }
    }
  </style>
</body>
</html>
