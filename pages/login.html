<!-- ğŸ”¥ Firebase logowanie -->
<script type="module">
  import { app, auth } from "/js/firebase.js";
  import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-auth.js";

  const firebaseAuth = auth || getAuth(app);
  const loginForm = document.getElementById("loginForm");
  const loginBtn = document.getElementById("loginBtn");

  loginForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();
    const userType = document.getElementById("userType").value;

    if (!email || !password || !userType) {
      alert("UzupeÅ‚nij wszystkie pola.");
      return;
    }

    loginBtn.textContent = "Logowanie...";
    loginBtn.disabled = true;

    try {
      const userCredential = await signInWithEmailAndPassword(firebaseAuth, email, password);
      const user = userCredential.user;

      // Zapis do localStorage
      localStorage.setItem("loggedIn", "true");
      localStorage.setItem("userEmail", email);

      // ğŸ” ADMIN LOGIN
      if (email === "arkadiuszgruca41@gmail.com") {
        localStorage.setItem("userType", "admin");
        alert("Witaj ponownie, Administratorze ğŸ’");
        window.location.href = "/pages/panel-admin.html";
        return;
      }

      // ğŸ” NORMALNI UÅ»YTKOWNICY
      localStorage.setItem("userType", userType);

      if (userType === "client") {
        alert("Witaj ponownie, Kliencie ğŸ’");
        window.location.href = "/pages/panel-klient.html";
      } else if (userType === "company") {
        alert("Witaj ponownie, Wykonawco ğŸ’");
        window.location.href = "/pages/panel-firma.html";
      }

    } catch (error) {
      console.error("BÅ‚Ä…d logowania:", error);
      if (error.code === "auth/invalid-credential") {
        alert("âŒ NieprawidÅ‚owy e-mail lub hasÅ‚o.");
      } else if (error.code === "auth/user-not-found") {
        alert("âŒ Konto o podanym adresie e-mail nie istnieje.");
      } else {
        alert("âš ï¸ BÅ‚Ä…d logowania: " + error.message);
      }
    } finally {
      loginBtn.textContent = "Zaloguj siÄ™";
      loginBtn.disabled = false;
    }
  });
</script>
